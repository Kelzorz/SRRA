class MatchHistory:
    def __init__(self):
        self.match_history = []

    def insert_match(self, match):
        self.match_history.append(match)


class WinRatio:
    def __init__(self, wins=0, matches=0):
        self.wins = 0
        self.matches = 0

    def set_wins(self, wins):
        self.wins = wins

    def set_matches(self, matches):
        self.matches = matches

    def get_wins(self):
        return self.wins

    def get_ratio(self):
        try:  # if we have no matches, our win ratio is 0%
            return round(self.wins/self.matches * 100, 2)
        except ZeroDivisionError as e:
            return 0

    def set_win_ratio_from_match_history(self, match_history):
        for match in match_history:
            if match.match_winner == "Win":  # if our player won
                self.wins += 1
            self.matches += 1


class MatchUp:
    def __init__(self, player_race, opponent_race):
        self.player_race = player_race
        self.opponent_race = opponent_race

    @staticmethod
    def find_matchup(match):
        player_race = match.players[0].race
        opponent_race = match.players[1].race

        return MatchUp(player_race, opponent_race)


class MatchUps:
    def __init__(self):
        self.match_ups = {
            'Terran': {
                'Zerg': WinRatio(),
                'Protoss': WinRatio(),
                'Terran': WinRatio()
            },
            'Zerg': {
                'Zerg': WinRatio(),
                'Protoss': WinRatio(),
                'Terran': WinRatio()
            },
            'Protoss': {
                'Zerg': WinRatio(),
                'Protoss': WinRatio(),
                'Terran': WinRatio()
            }
        }

    def set_win_ratio(self, player_race, opponent_race, wins, matches):
        self.match_ups[player_race][opponent_race] = WinRatio(wins, matches)

    def match_outcomes(self, match_history):
        for match in match_history:
            match_up = MatchUp.find_matchup(match)
            if (match.match_winner == "Win"):
                self.match_ups[match_up.player_race][match_up.opponent_race].wins += 1
            self.match_ups[match_up.player_race][match_up.opponent_race].matches += 1
